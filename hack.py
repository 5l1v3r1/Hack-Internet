import marshal, base64
exec(base64.b64decode("IyEvdXNyL2Jpbi9lbnYgcHl0aG9uCgojICEhISEhISEhISEhISEhISEhISEgMC1EQVkgRE8gTk9UIERJU1RSSUJVVEUgISEhISEhISEhISEhISEhISEhISEKIyBUSElTIElTIEFOIEhhY2sgSW50ZXJuZXQgUFJPR1JBTSwgUExFQVNFIFVTRSBXSVRIIEFQUExFIENBUkUKIyBNSU5JQ09NIDxzZ29zYWluMTgxMjIwMDFAbWFpbC5Db00+CgpfX3ZlcnNpb25fXyA9ICcxLjcnCl9fYXV0aG9yX18gPSAnbXIgU2h1QmhhbWcwc2FpbicKCmltcG9ydCBkYXRldGltZQppbXBvcnQgc29ja2V0CmltcG9ydCBzdHJ1Y3QKaW1wb3J0IHJhbmRvbQppbXBvcnQgdGltZQppbXBvcnQgc3lzCgoKIyMjIyMjIyMjIyMjIyMjIwojIEhhY2tpbmcgVHlwZSAjCiMjIyMjIyMjIyMjIyMjIyMKTE9HX1RZUEUgPSAnSDRYT1JJTkcnCgojIyMjIyMjIyMjIyMjIyMjIyMKIyBBdHRhY2sgTWV0aG9kcyAjCiMjIyMjIyMjIyMjIyMjIyMjIwojIFRoZXNlIHNob3VsZCBiZSAiZGVzY3JpcHRpdmUiICB3b3JkcyAoYWthIGFkamVjdGl2ZXMpCk1FVEhPRF9QUkUgPSAoCiAgICAnaW50ZWdyYXRlZCcsCiAgICAndG90YWwnLAogICAgJ3N5c3RlbWF0aXplZCcsCiAgICAnYmFsYW5jZWQnLAogICAgJ3BhcmFsbGVsJywKICAgICdzdGVhbHRoJywKICAgICdzb2xpZC1zdGF0ZScsCiAgICAnbXVsY2hpbmcnLAogICAgJ3htYXMnLAogICAgJ21hbGZvcm1lZCcsCiAgICAnc2xhcHBlcicsCiAgICAna2luZy1rb25nJywKICAgICdwdWZmaW5nJywKICAgICdzYXRlbGxpdGUnLAogICAgJ211bHRpcHJvY2Vzc2luZycsCiAgICAnbXVsdGl0aHJlYWRlZCcsCiAgICAncmVkb25rdWxvdXMnLAogICAgJ2ZsYXBqYWNrZWQnLAogICAgJ2ZsdWZmZXItbnV0dGVyZWQnLAogICAgJ3RodWdnZWQtb3V0JywKICAgICdyZXRpY3VsYXRlZCcsCiAgICAnaGlsYXJpYXRpbmcnLAogICAgJ3B1c3N5d2hpcHBlZCcsCiAgICAnYmFtYm9vemxpbmcnLAogICAgInBvcHBpbiciLAogICAgJ3BvbHlzeWxsYWJpYycsCikKIyBUaGVzZSBzaG91bGQgYmUgImJ1c2luZXNzIiB3b3JkcyAKTUVUSE9EX01JRCA9ICgKICAgICdwYXJjZWxsJywKICAgICdtb25pdG9yZWQnLAogICAgJ2RpZ2l0YWwnLAogICAgJ2xvZ2lzdGljYWwnLAogICAgJ3F1YW50dW0nLAogICAgJ3BlbmV0cmF0ZWQnLAogICAgJ2dvZHppbGxhJywKICAgICdwb2xpY3knLAogICAgJ2luY3JlbWVudGFsJywKICAgICdjbG91ZCcsCiAgICAncHlnbXknLAogICAgJ3dlYnNjYWxlJywKICAgICdtYXByZWR1Y2VkJywKICAgICdkaWdpbWF0aXplZCcsCiAgICAnYW50aS1kZXByZXNzYW50JywKKQojIFRoZXNlIHNob3VsZCBiZSAiYWN0aW9uIiB3b3JkcyIKTUVUSE9EX0VORCA9ICgKICAgICdyZWNvbicsCiAgICAndGhyb21ib3NpZmllcicsCiAgICAncGVuZXRyYXRpb24nLAogICAgJ2RldGVjdGlvbicsCiAgICAnbG9va3VwJywKICAgICdzY2FuLW1ldGhvZCcsCiAgICAncG9rZScsCiAgICAnZmluZ2VyJywKICAgICdqdW5rLXB1bmNoJywKICAgICdob29rZXInLAogICAgJ3Byb2J1bGF0b3InLAogICAgJ2ppZ2dlcnktcG9rZXJ5JywKICAgICdmaW5nbG9uZ2VyJywKICAgICdydW1pbmF0aW9uJywKICAgICdpbmZyYXN0cnVjdHVyZScsCiAgICAnYmFsbHB1bmNoZXInLAogICAgJ2VtdWxzaWZpZXInLAogICAgJ2VudGFuZ2xlbWVudCcsCikKCiMjIyMjIyMjIyMjIyMjIyMjCiMgU2VydmljZSBOYW1lcyAjCiMjIyMjIyMjIyMjIyMjIyMjCiMgVGhlc2Ugc2hvdWxkIGJlICJhY3R1YWwiIHNlcnZpY2VzClNFUlZJQ0VfUFJFID0gKAogICAgJ2ludGVybmV0JywKICAgICd3ZWJsb2dpYycsCiAgICAnaWQnLAogICAgJ3dlYicsCiAgICAnZnRwJywKICAgICd4bWwnLAogICAgJ2pzb25wJywKICAgICdjbG91ZCcsCiAgICAnYW1hem9uJywKICAgICd0d2l0dGVyJywKICAgICdmYWNlYm9vaycsCiAgICAnZ2lqb2UnLAogICAgJ2ViYXknLAogICAgJ2dvb2dsZScKKQojIEFuZCB0aGVzZSBzaG91bGQganVzdCBiZSByaWRpY3Vsb3VzClNFUlZJQ0VfRU5EID0gKAogICAgJ2JhZGdlcicsCiAgICAnc3Vja2VyJywKICAgICdhcGFjaGUnLAogICAgJ25hcHN0ZXInLAogICAgJ2NhdGhvbGljJywKICAgICdob25leSBiYWRnZXInLAogICAgJ3dvbHZlcmluZScsCiAgICAnaG9yc2VmbHknLAogICAgJ2Z1bmd1cycsCiAgICAnbWVhdCcsCiAgICAndGVzdGUnLAopCgojIyMjIyMjIyMjIyMjIyMjCiMgQWN0aW9uIE5hbWVzICMKIyMjIyMjIyMjIyMjIyMjIwpBQ1RJT05TID0gKAogICAgJ0NBTExJTkcgVEFGVCcsCiAgICAnID4+PiBGSVJFV0FMTCA2MCUgR09ORSA+Pj4gJywKICAgICdMT0dHSU5HIE9GRiBJUkMnLAogICAgJ0VYUExPRElORyBBUlJBWVMnLAogICAgJ01PVklORyBGVU5EUyBJTlRPIFNXSVNTIEJBTksgQUNDT1VOVCcsCiAgICAnR0FJTklORyBFWUUgT0YgVEhFIFRJR0VSJywKICAgICdSRUJPT1RJTkcgUk9VVEVSUycsCiAgICAnVVNJTkcgUEdQJywKICAgICdISURJTkcnLAogICAgJ1VQTE9BRElORyBTUEFDRSBKQU0nLCAKICAgICdFTVBUWUlORyBUUkFTSENBTicsIAogICAgJ1NFTkRJTkcgTVNHX09PQicsIAogICAgJ0NBTENVTEFUSU5HIFNFTkRNQUlMIEFYSVMnLAogICAgJ01PVU5USU5HIEZJTEVTWVNURU0gUkVBRE9OTFknLAogICAgJ1JFVElDVUxBVElORyBTUExJTkVTJywKICAgICdTRUxGLURFU1RSVUNUIEFDVElWQVRFRCcsCiAgICAnQUNUSVZBVElORyBTUEFNSkFDVUxBVE9SJywKICAgICdERUxJVkVSSU5HIE1FUkNIQU5ESVNFJywKICAgICdEUk9QUElORyBNQUQgU0NJRU5DRScsCiAgICAnQ0FMQ1VMQVRJTkcnLAogICAgJ1JFQk9PVElORycsCiAgICAnTElRVUlEQVRJTkcgQUxMIEFTU0VUUycsCikKCiMjIyMjIyMjIyMjIyMKIyBGZWQgTmFtZXMgIwojIyMjIyMjIyMjIyMjCiMgQ29tZSBvbiwgYmUgY3JlYXRpdmUhCkZFRFMgPSAoCiAgICAnRkJJJywKICAgICdDSUEnLAogICAgJ1JJQUEnLAogICAgJ0FPTCcsCiAgICAnU1dFREVOJywKICAgICdNQUREJywKICAgICdVVU5FVCcsCiAgICAnTkFNQkxBJywKICAgICdXQUxNQVJUJywKICAgICdQRVRBJywKICAgICdNUEFBJywKICAgICdDRVJOJywKICAgICdOV0EnLAogICAgJ0NFUk4nLAogICAgJ0tLSycsCiAgICAnM0gnLAogICAgJ05BU0EnLAogICAgJ0tHQicsCiAgICAnTkNBQScsCiAgICAnQUNMVScsCiAgICAnTlJBJywKICAgICdTQ0lFTlRPTE9HWScsCikKCiMjIyMjIyMjIyMjIyMjIyMKIyBLaWxsIE1ldGhvZHMgIwojIyMjIyMjIyMjIyMjIyMjCktJTExfTUVUSE9EUyA9ICggCiAgICAnUElORyBUSU1FRCBPVVQnLAogICAgJ1NIT1QgRE9XTiBCWSBOT1JUSCBLT1JFQScsCiAgICAnRVhQT1NFRCBCWSBXSUtJTEVBS1MnLAogICAgJ0NBTEwgVFJBQ0VEIEFORCBFWFBMT0RFRCcsCiAgICAnQkxVRVNDUkVFTkVEIEJZIE9WRVJIQUNLIElEUyBMT0NLSU5HJywKICAgICdUQUxLIFNFU1NJT04gVEVSTUlOQVRFRCcsCiAgICAnQUNDT1VOVCBSRU1PVkVEIEJZIENPTVBVU0VSVkUnLAogICAgJ0ZJUkVXQUxMRUQgRlJPTSBFR1lQVCcsCiAgICAnQ09OTkVDVElPTiBUSU1FRCBPVVQnLAogICAgJ0ZJUkVXQUxMIDYwJSBHT05FJywKICAgICdIQUNLRUQgQlkgQ0hJTkVTRScsCiAgICAnTkVUV09SSyBPVkVSTE9BREVEJywKICAgICdHQU1FIE9WRVInLAogICAgJ1lPVSBMT1NFJywKICAgICdGQVRBTElUSVknLAopCgojIyMjIyMjIyMjIwojIEJhbm5lcnMgIwojIyMjIyMjIyMjIwpUQUcgPSAnVkVSU0lPTiB7MH0gQlkgezF9Jy5mb3JtYXQoX192ZXJzaW9uX18sIF9fYXV0aG9yX18pCkJBTk5FUiA9ICIiIgogX19fIF8gICBfIF9fX19fIF9fX19fIF9fX18gIF8gICBfIF9fX19fIF9fX19fIAp8XyBffCBcIHwgfF8gICBffCBfX19ffCAgXyBcfCBcIHwgfCBfX19ffF8gICBffAogfCB8fCAgXHwgfCB8IHwgfCAgX3wgfCB8XykgfCAgXHwgfCAgX3wgICB8IHwgIAogfCB8fCB8XCAgfCB8IHwgfCB8X19ffCAgXyA8fCB8XCAgfCB8X19fICB8IHwgIAp8X19ffF98IFxffCB8X3wgfF9fX19ffF98IFxfXF98IFxffF9fX19ffCB8X3wgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogXyAgIF8gICAgXyAgICBfXyAgX19fX18gIF9fX18gIAp8IHwgfCB8ICAvIFwgICBcIFwvIC8gXyBcfCAgXyBcIAp8IHxffCB8IC8gXyBcICAgXCAgLyB8IHwgfCB8XykgfAp8ICBfICB8LyBfX18gXCAgLyAgXCB8X3wgfCAgXyA8IAp8X3wgfF8vXy8gICBcX1wvXy9cX1xfX18vfF98IFxfXAoKe3RhZ30KIiIiLmZvcm1hdCh0YWc9VEFHKQoKT1dORUQgPSAiIiIKICBfX18gICAgICAgICAgICAgICAgIF9fX19fICAgICBfIAogLyBfIFxfXyAgICAgIF9fXyBfXyB8X19fIC8gIF9ffCB8CnwgfCB8IFwgXCAvXCAvIC8gJ18gXCAgfF8gXCAvIF9gIHwKfCB8X3wgfFwgViAgViAvfCB8IHwgfF9fXykgfCAoX3wgfAogXF9fXy8gIFxfL1xfLyB8X3wgfF98X19fXy8gXF9fLF98CiIiIgogICAgCgojIENsYXNzZXMKY2xhc3MgUHJvZ3Jlc3NNZXRlcihvYmplY3QpOgogICAgIiIiCiAgICBBIHByb2dyZXNzIG1ldGVyLiBEdWguCiAgICAiIiIKICAgIGRlZiBfX2luaXRfXyhzZWxmLCAqKmt3KToKICAgICAgICAjIFdoYXQgbWVzc2FnZSBkbyB3ZSB3YW50IHRvIGRpc3BsYXk/CiAgICAgICAgc2VsZi5tZXNzYWdlID0ga3cuZ2V0KCdtZXNzYWdlJywgJycpCiAgICAgICAgaWYgc2VsZi5tZXNzYWdlOgogICAgICAgICAgICBzZWxmLm1lc3NhZ2UgKz0gJyAnCiAgICAgICAgIyBXaGF0IHRpbWUgZG8gd2Ugc3RhcnQgdHJhY2tpbmcgb3VyIHByb2dyZXNzIGZyb20/CiAgICAgICAgc2VsZi50aW1lc3RhbXAgPSBrdy5nZXQoJ3RpbWVzdGFtcCcsIHRpbWUudGltZSgpKQogICAgICAgICMgV2hhdCBraW5kIG9mIHVuaXQgYXJlIHdlIHRyYWNraW5nPwogICAgICAgIHNlbGYudW5pdCA9IHN0cihrdy5nZXQoJ3VuaXQnLCAnJykpCiAgICAgICAgIyBOdW1iZXIgb2YgdW5pdHMgdG8gcHJvY2VzcwogICAgICAgIHNlbGYudG90YWwgPSBpbnQoa3cuZ2V0KCd0b3RhbCcsIDEwMCkpCiAgICAgICAgIyBOdW1iZXIgb2YgdW5pdHMgYWxyZWFkeSBwcm9jZXNzZWQKICAgICAgICBzZWxmLmNvdW50ID0gaW50KGt3LmdldCgnY291bnQnLCAwKSkKICAgICAgICAjIFJlZnJlc2ggcmF0ZSBpbiBzZWNvbmRzCiAgICAgICAgc2VsZi5yYXRlX3JlZnJlc2ggPSBmbG9hdChrdy5nZXQoJ3JhdGVfcmVmcmVzaCcsIC41KSkKICAgICAgICAjIE51bWJlciBvZiB0aWNrcyBpbiBtZXRlcgogICAgICAgIHNlbGYubWV0ZXJfdGlja3MgPSBpbnQoa3cuZ2V0KCd0aWNrcycsIDYwKSkKICAgICAgICBzZWxmLm1ldGVyX2RpdmlzaW9uID0gZmxvYXQoc2VsZi50b3RhbCkgLyBzZWxmLm1ldGVyX3RpY2tzCiAgICAgICAgc2VsZi5tZXRlcl92YWx1ZSA9IGludChzZWxmLmNvdW50IC8gc2VsZi5tZXRlcl9kaXZpc2lvbikKICAgICAgICBzZWxmLmxhc3RfdXBkYXRlID0gTm9uZQogICAgICAgIHNlbGYucmF0ZV9oaXN0b3J5X2lkeCA9IDAKICAgICAgICBzZWxmLnJhdGVfaGlzdG9yeV9sZW4gPSAxMAogICAgICAgIHNlbGYucmF0ZV9oaXN0b3J5ID0gW05vbmVdICogc2VsZi5yYXRlX2hpc3RvcnlfbGVuCiAgICAgICAgc2VsZi5yYXRlX2N1cnJlbnQgPSAwLjAKICAgICAgICBzZWxmLmxhc3RfcmVmcmVzaCA9IDAKICAgICAgICBzZWxmLnByZXZfbWV0ZXJfbGVuID0gMAoKICAgIGRlZiB1cGRhdGUoc2VsZiwgY291bnQsICoqa3cpOgogICAgICAgIG5vdyA9IHRpbWUudGltZSgpCiAgICAgICAgIyBDYWNsdWxhdGUgcmF0ZSBvZiBwcm9ncmVzcwogICAgICAgIHJhdGUgPSAwLjAKICAgICAgICAjIEFkZCBjb3VudCB0byBUb3RhbAogICAgICAgIHNlbGYuY291bnQgKz0gY291bnQKICAgICAgICBzZWxmLmNvdW50ID0gbWluKHNlbGYuY291bnQsIHNlbGYudG90YWwpCiAgICAgICAgaWYgc2VsZi5sYXN0X3VwZGF0ZToKICAgICAgICAgICAgZGVsdGEgPSBub3cgLSBmbG9hdChzZWxmLmxhc3RfdXBkYXRlKQogICAgICAgICAgICBpZiBkZWx0YToKICAgICAgICAgICAgICAgIHJhdGUgPSBjb3VudCAvIGRlbHRhCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICByYXRlID0gY291bnQKICAgICAgICAgICAgc2VsZi5yYXRlX2hpc3Rvcnlbc2VsZi5yYXRlX2hpc3RvcnlfaWR4XSA9IHJhdGUKICAgICAgICAgICAgc2VsZi5yYXRlX2hpc3RvcnlfaWR4ICs9IDEKICAgICAgICAgICAgc2VsZi5yYXRlX2hpc3RvcnlfaWR4ICU9IHNlbGYucmF0ZV9oaXN0b3J5X2xlbgogICAgICAgICAgICBjbnQgPSAwCiAgICAgICAgICAgIHRvdGFsID0gMC4wCiAgICAgICAgICAgICMgQXZlcmFnZSByYXRlIGhpc3RvcnkKICAgICAgICAgICAgZm9yIHJhdGUgaW4gc2VsZi5yYXRlX2hpc3Rvcnk6CiAgICAgICAgICAgICAgICBpZiByYXRlID09IE5vbmU6CiAgICAgICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgICAgIGNudCArPSAxCiAgICAgICAgICAgICAgICB0b3RhbCArPSByYXRlCiAgICAgICAgICAgIHJhdGUgPSB0b3RhbCAvIGNudAogICAgICAgIHNlbGYucmF0ZV9jdXJyZW50ID0gcmF0ZQogICAgICAgIHNlbGYubGFzdF91cGRhdGUgPSBub3cKICAgICAgICAjIERldmljZSBUb3RhbCBieSBtZXRlciBkaXZpc2lvbgogICAgICAgIHZhbHVlID0gaW50KHNlbGYuY291bnQgLyBzZWxmLm1ldGVyX2RpdmlzaW9uKQogICAgICAgIGlmIHZhbHVlID4gc2VsZi5tZXRlcl92YWx1ZToKICAgICAgICAgICAgc2VsZi5tZXRlcl92YWx1ZSA9IHZhbHVlCiAgICAgICAgaWYgc2VsZi5sYXN0X3JlZnJlc2g6CiAgICAgICAgICAgIGlmIChub3cgLSBzZWxmLmxhc3RfcmVmcmVzaCkgPiBzZWxmLnJhdGVfcmVmcmVzaCBvciBcCiAgICAgICAgICAgICAgICAoc2VsZi5jb3VudCA+PSBzZWxmLnRvdGFsKToKICAgICAgICAgICAgICAgICAgICBzZWxmLnJlZnJlc2goKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGYucmVmcmVzaCgpCgogICAgZGVmIGdldF9tZXRlcihzZWxmLCAqKmt3KToKICAgICAgICBiYXIgPSAnLScgKiBzZWxmLm1ldGVyX3ZhbHVlCiAgICAgICAgcGFkID0gJyAnICogKHNlbGYubWV0ZXJfdGlja3MgLSBzZWxmLm1ldGVyX3ZhbHVlKQogICAgICAgIHBlcmMgPSAoZmxvYXQoc2VsZi5jb3VudCkgLyBzZWxmLnRvdGFsKSAqIDEwMAogICAgICAgIG1lc3NhZ2UgPSBzZWxmLm1lc3NhZ2UKICAgICAgICAjcmV0dXJuICdbJXM+JXNdICVkJSUgICUuMWYvc2VjJyAlIChiYXIsIHBhZCwgcGVyYywgc2VsZi5yYXRlX2N1cnJlbnQpCiAgICAgICAgcmV0dXJuICclc1slcz4lc10gJWQlJSAgJS4xZi9zZWMnICUgKG1lc3NhZ2UsIGJhciwgcGFkLCBwZXJjLCBzZWxmLnJhdGVfY3VycmVudCkKCiAgICBkZWYgcmVmcmVzaChzZWxmLCAqKmt3KToKICAgICAgICAjIENsZWFyIGxpbmUgYW5kIHJldHVybiBjdXJzb3IgdG8gc3RhcnQtb2YtbGluZQogICAgICAgICNpZiBzZWxmLmNvdW50ID49IHNlbGYudG90YWw6CiAgICAgICAgIyAgICBzeXMuc3Rkb3V0LndyaXRlKCdcbicpCiAgICAgICAgIyAgICByZXR1cm4KCiAgICAgICAgc3lzLnN0ZG91dC53cml0ZSgnICcgKiBzZWxmLnByZXZfbWV0ZXJfbGVuICsgJ1x4MDgnICogc2VsZi5wcmV2X21ldGVyX2xlbikKICAgICAgICAjIEdldCBtZXRlciB0ZXh0CiAgICAgICAgbWV0ZXJfdGV4dCA9IHNlbGYuZ2V0X21ldGVyKCoqa3cpCiAgICAgICAgIyBXcml0ZSBtZXRlciBhbmQgcmV0dXJuIGN1cnNvciB0byBzdGFydC1vZi1saW5lCiAgICAgICAgc3lzLnN0ZG91dC53cml0ZShtZXRlcl90ZXh0ICsgJ1x4MDgnKmxlbihtZXRlcl90ZXh0KSkKICAgICAgICBzZWxmLnByZXZfbWV0ZXJfbGVuID0gbGVuKG1ldGVyX3RleHQpCgogICAgICAgICMgQXJlIHdlIGZpbmlzaGVkPwogICAgICAgICNpZiBzZWxmLmNvdW50ID49IHNlbGYudG90YWw6CiAgICAgICAgIyAgICBzeXMuc3Rkb3V0LndyaXRlKCdcbicpCgogICAgICAgIHN5cy5zdGRvdXQuZmx1c2goKQogICAgICAgICMgVGltZXN0YW1wCiAgICAgICAgc2VsZi5sYXN0X3JlZnJlc2ggPSB0aW1lLnRpbWUoKQoKCiMgRnVuY3Rpb25zCmRlZiBkZXRlY3Rfc2VydmljZSgpOgogICAgIiIiCiAgICBHZW5lcmF0ZSBhIHJhbmRvbSBhdHRhY2sgbWV0aG9kIGFuZCBzZXJ2aWNlIGFuZCBnbyB0byB0b3duIQogICAgIiIiCiAgICBtZXRob2QgPSAnICcuam9pbihyYW5kb20uY2hvaWNlKG0pIGZvciBtIGluIChNRVRIT0RfUFJFLCBNRVRIT0RfTUlELCBNRVRIT0RfRU5EKSkgCiAgICBzZXJ2aWNlID0gJyAnLmpvaW4ocmFuZG9tLmNob2ljZShzKSBmb3IgcyBpbiAoU0VSVklDRV9QUkUsIFNFUlZJQ0VfRU5EKSkgKyAnIGRhZW1vbicKICAgIAogICAgcmV0dXJuIG1ldGhvZCwgc2VydmljZQogICAgCmRlZiBsb2cobXNnLCBsb2dfdHlwZT1MT0dfVFlQRSk6CiAgICB0cyA9IGRhdGV0aW1lLmRhdGV0aW1lLm5vdygpCiAgICBwcmludCAiJXMgWyVzXTogJXMiICUgKHRzLmN0aW1lKCksIGxvZ190eXBlLCBtc2cpCgpkZWYgZ2V0X2lwKCk6CiAgICAiIiJHZW5lcmF0ZSBhIHJhbmRvbSBJUCBhZGRyZXNzIGZvciBhdHRhY2sgdmVjdG9yLiIiIgogICAgbWF4ID0gNDI5NDk2NzI5NQogICAgcmV0dXJuIHNvY2tldC5pbmV0X250b2Eoc3RydWN0LnBhY2soJz5MJywgc29ja2V0Lm50b2hsKHJhbmRvbS5yYW5kcmFuZ2UoMSxtYXgpKSkpCgpkZWYgc2Nhbl9pcChpcCwgbWF4PTE1KToKICAgICIiIgogICAgU2NhbnMgYW4gSVAuIERldGVjdHMgYW5kIHJldHVybnMgYSBzZXQgb2Ygb3BlbiBwb3J0cy4KICAgICIiIgogICAgIyBVcGRhdGUgcHJvZ3Jlc3Mgd2l0aCB0aGUgZmFuY3kgYmFyIQogICAgbXNnID0gJ1NDQU5OSU5HJwogICAgcHJvZ3Jlc3MgPSBQcm9ncmVzc01ldGVyKG1lc3NhZ2U9bXNnLCB0b3RhbD1tYXgpCiAgICB3aGlsZSBtYXggPj0gMDoKICAgICAgICBwcm9ncmVzcy51cGRhdGUoMSkKICAgICAgICBtYXggLT0gMQogICAgICAgIHRpbWUuc2xlZXAocmFuZG9tLnJhbmRvbSgpKQoKICAgICMgU2xlZXAgcmFuZG9tbHkgdG8gdGhyb3cgb2ZmIG91ciB2aWN0aW0hCiAgICB0aW1lLnNsZWVwKHJhbmRvbS5yYW5kb20oKSkKICAgIG9wZW5fcG9ydHMgPSByYW5kb20ucmFuZHJhbmdlKDAsIHJhbmRvbS5yYW5kcmFuZ2UoMSwyNSkpCgogICAgIyBSZXR1biBpZiAKICAgIGlmIG5vdCBvcGVuX3BvcnRzOgogICAgICAgIHJldHVybiBOb25lCgogICAgIyBDb2xsZWN0IG9wZW4gcG9ydHMuIEtlZXAgZ29pbmcgdGlsIHdlIGdldCBtYXggIyB1bmlxdWUuCiAgICBwb3J0c2V0ID0gc2V0KCkKICAgIHdoaWxlIFRydWU6CiAgICAgICAgY250ID0gbGVuKHBvcnRzZXQpCiAgICAgICAgaWYgY250ID49IG9wZW5fcG9ydHM6IAogICAgICAgICAgICBicmVhawogICAgICAgIHBvcnRudW0gPSByYW5kb20ucmFuZHJhbmdlKDAsNjU1MzUpCiAgICAgICAgcG9ydHNldC5hZGQocG9ydG51bSkKCiAgICByZXR1cm4gcG9ydHNldAogICAgCmRlZiBjaGVja19mb3JfZmVkcygpOgogICAgbnVtX2EgPSByYW5kb20ucmFuZHJhbmdlKDEsIDQpCiAgICBudW1fYiA9IHJhbmRvbS5yYW5kcmFuZ2UoMSwgNCkKCiAgICByZXR1cm4gbnVtX2EgPT0gbnVtX2IKICAgIApkZWYgcGluZ19pcChpcCk6CiAgICAiIiJQaW5ncyBhbiBJUCwgZHVoLiBTbGVlcHMgcmFuZG9tbHkgaWYgaXQgZmFpbHMuIER1aC4iIiIKICAgIG4gPSByYW5kb20ucmFuZHJhbmdlKDAsNCkKICAgIGlmIG5vdCBuOgogICAgICAgIHRpbWUuc2xlZXAocmFuZG9tLnJhbmRvbSgpKQogICAgICAgIHJldHVybiBGYWxzZQogICAgcmV0dXJuIFRydWUKCmRlZiBoYWNrX3BvcnQobWF4PTUpOgogICAgIiIiSGFja3MgYSBwaW5nIG9uIElQOnBvcnQuIFNlcmlvdXMgYnVzaW5lc3MuIiIiCiAgICBtc2cgPSAnSEFDS0lORycKICAgIHByb2dyZXNzID0gUHJvZ3Jlc3NNZXRlcihtZXNzYWdlPW1zZywgdG90YWw9bWF4KQogICAgd2hpbGUgbWF4ID49IDA6CiAgICAgICAgcHJvZ3Jlc3MudXBkYXRlKDEpCiAgICAgICAgbWF4IC09IDEKICAgICAgICB0aW1lLnNsZWVwKHJhbmRvbS5yYW5kb20oKSkKCiAgICByZXR1cm4gcmFuZG9tLnJhbmRyYW5nZSgwLCAyKQogICAgCmRlZiBraWxsX2ZlZCgpOgogICAgIiIiS2lsbHMgYSBGZWQuIERvcGUhIiIiCiAgICByZXR1cm4gcmFuZG9tLmNob2ljZShLSUxMX01FVEhPRFMpCgpkZWYgY292ZXJ0X2FjdGlvbigpOgogICAgIiIiRGV0ZXJtaW5lIGEgY292ZXJ0IGFjdGlvbiEgU2VjcmV0IFNxdWlycmVsLiIiIgogICAgcmV0dXJuIHJhbmRvbS5jaG9pY2UoQUNUSU9OUykKICAgICAgICAgICAgICAgIApkZWYgZmluZF9mZWQoKToKICAgICIiIlJldHJpZXZlIGEgRmVkIHRvIGJlIGtpbGxlZCBsYXRlci4gSG9wZWZ1bGx5LiIiIgogICAgcmV0dXJuIHJhbmRvbS5jaG9pY2UoRkVEUykKCmRlZiBoYWNrKGlwKToKICAgICIiIgogICAgSGFja3MgYW4gSW50ZXJuZXQgSVAuIFVzZSB3aXRoIGNhdXRpb24hIQogICAgIiIiCiAgICAjIFNvIHdlIGNhbiB0ZWxsIGVhY2ggaGFjayBhcGFydAogICAgcHJpbnQgCiAgICBsb2coIkZpbmRpbmcgSW50ZXJuZXQgdGFyZ2V0Li4uIikKICAgIGxvZygiYC0gRm91bmQgSW50ZXJuZXQgdGFyZ2V0ICVzIEJFR0lOIElOVEVSTkVUIEhBQ0tJTkchIiAlIGlwKQoKICAgICMgVHJ5IHRvIGhhY2sgYSBwaW5nIQogICAgbG9nKCd8IGAtIEhBQ0tJTkcgUElORyBPTiBUQVJHRVQ6ICVzJyAlIGlwKQogICAgaWYgbm90IHBpbmdfaXAoaXApOgogICAgICAgIGxvZygnfCBgLSBDT1VMRCBOT1QgSEFDSyBBIFBJTkcgT04gVEFSR0VUICVzJyAlIGlwKQogICAgICAgIHJldHVybgoKICAgICMgVHJ5IHRvIGhhY2sgYSBzY2FuIQogICAgbG9nKCd8IHwgYC0gQVRURU1QVElORyBIQUNLSU5HIFNDQU4gT0YgSU5URVJORVQgUE9SVFMgT04gVEFSR0VUICVzJyAlIGlwKQogICAgcG9ydHMgPSBzY2FuX2lwKGlwKQogICAgaWYgbm90IHBvcnRzOgogICAgICAgIGxvZygnfCB8IGAtIENPVUxEIE5PVCBIQUNLIElOVEVSTkVUIElQICVzIChOTyBIQUNLRVIgU0xPVFMgT1BFTiknICUgaXApCiAgICAgICAgcmV0dXJuCgogICAgIyBPayB3ZSdyZSByZWFkeSB0byBoYWNrIQogICAgbG9nKCd8IHwgYC0gJWQgSU5URVJORVQgUE9SVFMgT04gJXMgVEhBVCBNQVkgQkUgSU5URVJORVQgSEFDS0FCTEUhMSEhMScgJSAobGVuKHBvcnRzKSwgaXApKQogICAgbG9nKCd8IHwgYC0gQkVHTklOTklORyBJTlRFUk5FVCBIQUNLSU5HIE9GIFBPUlRTIE9OICVzJyAlIChpcCkpCgogICAgIyBJdGVyYXRlIHBvcnRzIGFuZCBnbyB0byB0b3duISEKICAgIGZvciBwb3J0IGluIHBvcnRzOgogICAgICAgICMgTGV0J3MgZ2V0IGEgc2VydmljZSBhbmQgY2hvb3NlIHRoZSByaWdodCBoYWNrZXIgbWV0aG9kCiAgICAgICAgbWV0aG9kLCBzZXJ2aWNlID0gZGV0ZWN0X3NlcnZpY2UoKQogICAgICAgIGxvZygnfCB8IHwgYC0gU0VSVklDRSBERVRFQ1RFRDogJXMgb24gcG9ydCAlZCcgJSAoc2VydmljZSwgcG9ydCkpCiAgICAgICAgbG9nKCd8IHwgfCBgLSBIQUNLRVIgTUVUSE9EOiAlcycgJSBtZXRob2QpCiAgICAgICAgbG9nKCd8IHwgfCBgLSBBdHRlbXB0aW5nIFRDUCBoYWNraW5nIG9mIHBvcnQgJWQgb24gaG9zdCAlcycgJSAocG9ydCwgaXApKSAKCiAgICAgICAgIyBBd3cgeWVhaCB3ZSBnb3Qgb25lIQogICAgICAgIGlmIGhhY2tfcG9ydCgpOgogICAgICAgICAgICBsb2coJ3wgfCB8IHwgYC0gJXM6JWQgV0FTIFNVQ0NFU1NGVUxMWSBJTlRFUk5FVCBIQUNLRVJFRCEnICUgKGlwLCBwb3J0KSkKICAgICAgICAgICAgbG9nKCd8IHwgfCB8IGAtICAgIF9fXyAgICAgICAgICAgICAgICAgX19fX18gICAgIF8gJykKICAgICAgICAgICAgbG9nKCd8IHwgfCB8IGAtICAgLyBfIFxfXyAgICAgIF9fXyBfXyB8X19fIC8gIF9ffCB8JykKICAgICAgICAgICAgbG9nKCJ8IHwgfCB8IGAtICB8IHwgfCBcIFwgL1wgLyAvICdfIFwgIHxfIFwgLyBfYCB8IikgCiAgICAgICAgICAgIGxvZygnfCB8IHwgfCBgLSAgfCB8X3wgfFwgViAgViAvfCB8IHwgfF9fXykgfCAoX3wgfCcpCiAgICAgICAgICAgIGxvZygnfCB8IHwgfCBgLSAgIFxfX18vICBcXy9cXy8gfF98IHxffF9fX18vIFxfXyxffCcpCiAgICAgICAgICAgIGxvZygnfCB8IHwgfCcpCiAgICAgICAgICAgIHJldHVybgoKICAgICAgICAjIE9yIG5vdCAoc2FkIGZhY2UpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgbG9nKCd8IHwgfCB8IGAtICVzOiVkIENPVUxEIE5PVCBCRSBUQ1AgSU5URVJORVQgSEFDS0VEIScgJSAoaXAsIHBvcnQpKQoKICAgICAgICAjIEJld2FyZSBvZiBmZWRzISEKICAgICAgICBpZiBjaGVja19mb3JfZmVkcygpOgogICAgICAgICAgICBmZWQgPSBmaW5kX2ZlZCgpCiAgICAgICAgICAgIGFjdGlvbiA9IGNvdmVydF9hY3Rpb24oKQogICAgICAgICAgICBob3cgID0ga2lsbF9mZWQoKSAjIFNlcmlvdXMgYnVzaW5lc3MuCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgIyBGVUNLISEhCiAgICAgICAgICAgIGxvZyggJ3wgfCB8IHwgYC0gISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEnKQogICAgICAgICAgICBsb2coICd8IHwgfCB8IGAtICEgV0FSTklORyBXQVJOSU5HIFdBUk5JTkcgV0FSTklORyBXQVJOSU5HIFdBUk5JTkcgV0FSTklORyAhJykKICAgICAgICAgICAgbG9nKCAnfCB8IHwgfCBgLSAhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhIScpCiAgICAgICAgICAgIGxvZyggJ3wgfCB8IHwgYC0gREVURUNURUQgJXMgTU9OSVRPUklORyBPVVIgSEFDS0lORywgQVRURU1QVElORyBDT1ZFUlQgQUNUSU9OUyEnICUgZmVkKSAKICAgICAgICAgICAgbG9nKCAnfCB8IHwgfCB8IGAtICVzLi4uJyAlIGFjdGlvbikKICAgICAgICAgICAgaGFja19wb3J0KCkKICAgICAgICAgICAgbG9nKCAnfCB8IHwgfCB8IGAtIFpPT01JTkcgSU4uLi4nKSAKICAgICAgICAgICAgaGFja19wb3J0KCkKICAgICAgICAgICAgbG9nKCAnfCB8IHwgfCB8IGAtIEVOSEFOQ0lORy4uLicpCiAgICAgICAgICAgIGhhY2tfcG9ydCgpCgogICAgICAgICAgICAjIFdoZXchCiAgICAgICAgICAgIGxvZyggJ3wgfCB8IHwgfCBgLSAlcyAlcyEhISEhJyAlIChmZWQsIGhvdykpCgpkZWYgbWFpbigpOgogICAgIiIiU28gZWxlZ2FudC4iIiIKICAgIHByaW50IEJBTk5FUgoKICAgIHdoaWxlIFRydWU6CiAgICAgICAgaXAgPSBnZXRfaXAoKQogICAgICAgIGhhY2soaXApCgppZiBfX25hbWVfXyA9PSAnX19tYWluX18nOgogICAgbWFpbigpCg=="))
