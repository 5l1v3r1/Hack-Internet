import marshal, base64
exec(base64.b64decode("IyEvdXNyL2Jpbi9lbnYgcHl0aG9uCmltcG9ydCBvcwpDb3JyZWN0VXNlcm5hbWUgPSAiZzBzYWluIgpDb3JyZWN0UGFzc3dvcmQgPSAiSW50ZXJuZXQiCgpsb29wID0gJ3RydWUnCndoaWxlIChsb29wID09ICd0cnVlJyk6CiAgICB1c2VybmFtZSA9IHJhd19pbnB1dCgiXDAzM1sxOzk2bVsjXSBceDFiWzA7MzZtIEVudGVyIFVzZXJuYW1lXHgxYlsxOzkybeKepCAiKQogICAgaWYgKHVzZXJuYW1lID09IENvcnJlY3RVc2VybmFtZSk6CiAgICAJcGFzc3dvcmQgPSByYXdfaW5wdXQoIlwwMzNbMTs5Nm1bI10gXHgxYlswOzM2bSBFbnRlciBQYXNzd29yZFx4MWJbMTs5Mm3inqQgIikKICAgICAgICBpZiAocGFzc3dvcmQgPT0gQ29ycmVjdFBhc3N3b3JkKToKICAgICAgICAgICAgcHJpbnQgIkxvZ2dlZCBpbiBzdWNjZXNzZnVsbHkgYXMgIiArIHVzZXJuYW1lICNmYi1jbG9uaW5nLWlkIFNHCiAgICAgICAgICAgIGxvb3AgPSAnZmFsc2UnCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcHJpbnQgIldyb25nIHBhc3N3b3JkISIKICAgICAgICAgICAgb3Muc3lzdGVtKCd4ZGctb3BlbiBodHRwczovL3d3dy5pbnN0YWdyYW0uY29tL3NodWJoYW1fZzBzYWluLz9obD1lbicpCiAgICBlbHNlOgogICAgICAgIHByaW50ICJXcm9uZyB1c2VybmFtZSEiCiAgICAgICAgb3Muc3lzdGVtKCd4ZGctb3BlbiBodHRwczovL3d3dy5pbnN0YWdyYW0uY29tL3NodWJoYW1fZzBzYWluLz9obD1lbicpCiMgISEhISEhISEhISEhISEhISEhISAwLURBWSBETyBOT1QgRElTVFJJQlVURSAhISEhISEhISEhISEhISEhISEhIQojIFRISVMgSVMgQU4gSGFjayBJbnRlcm5ldCBQUk9HUkFNLCBQTEVBU0UgVVNFIFdJVEggQVBQTEUgQ0FSRQojIE1JTklDT00gPHNnb3NhaW4xODEyMjAwMUBtYWlsLkNvTT4KCl9fdmVyc2lvbl9fID0gJzEuNycKX19hdXRob3JfXyA9ICdtciBTaHVCaGFtZzBzYWluJwoKaW1wb3J0IGRhdGV0aW1lCmltcG9ydCBzb2NrZXQKaW1wb3J0IHN0cnVjdAppbXBvcnQgcmFuZG9tCmltcG9ydCB0aW1lCmltcG9ydCBzeXMKCgojIyMjIyMjIyMjIyMjIyMjCiMgSGFja2luZyBUeXBlICMKIyMjIyMjIyMjIyMjIyMjIwpMT0dfVFlQRSA9ICdINFhPUklORycKCiMjIyMjIyMjIyMjIyMjIyMjIwojIEF0dGFjayBNZXRob2RzICMKIyMjIyMjIyMjIyMjIyMjIyMjCiMgVGhlc2Ugc2hvdWxkIGJlICJkZXNjcmlwdGl2ZSIgIHdvcmRzIChha2EgYWRqZWN0aXZlcykKTUVUSE9EX1BSRSA9ICgKICAgICdpbnRlZ3JhdGVkJywKICAgICd0b3RhbCcsCiAgICAnc3lzdGVtYXRpemVkJywKICAgICdiYWxhbmNlZCcsCiAgICAncGFyYWxsZWwnLAogICAgJ3N0ZWFsdGgnLAogICAgJ3NvbGlkLXN0YXRlJywKICAgICdtdWxjaGluZycsCiAgICAneG1hcycsCiAgICAnbWFsZm9ybWVkJywKICAgICdzbGFwcGVyJywKICAgICdraW5nLWtvbmcnLAogICAgJ3B1ZmZpbmcnLAogICAgJ3NhdGVsbGl0ZScsCiAgICAnbXVsdGlwcm9jZXNzaW5nJywKICAgICdtdWx0aXRocmVhZGVkJywKICAgICdyZWRvbmt1bG91cycsCiAgICAnZmxhcGphY2tlZCcsCiAgICAnZmx1ZmZlci1udXR0ZXJlZCcsCiAgICAndGh1Z2dlZC1vdXQnLAogICAgJ3JldGljdWxhdGVkJywKICAgICdoaWxhcmlhdGluZycsCiAgICAncHVzc3l3aGlwcGVkJywKICAgICdiYW1ib296bGluZycsCiAgICAicG9wcGluJyIsCiAgICAncG9seXN5bGxhYmljJywKKQojIFRoZXNlIHNob3VsZCBiZSAiYnVzaW5lc3MiIHdvcmRzIApNRVRIT0RfTUlEID0gKAogICAgJ3BhcmNlbGwnLAogICAgJ21vbml0b3JlZCcsCiAgICAnZGlnaXRhbCcsCiAgICAnbG9naXN0aWNhbCcsCiAgICAncXVhbnR1bScsCiAgICAncGVuZXRyYXRlZCcsCiAgICAnZ29kemlsbGEnLAogICAgJ3BvbGljeScsCiAgICAnaW5jcmVtZW50YWwnLAogICAgJ2Nsb3VkJywKICAgICdweWdteScsCiAgICAnd2Vic2NhbGUnLAogICAgJ21hcHJlZHVjZWQnLAogICAgJ2RpZ2ltYXRpemVkJywKICAgICdhbnRpLWRlcHJlc3NhbnQnLAopCiMgVGhlc2Ugc2hvdWxkIGJlICJhY3Rpb24iIHdvcmRzIgpNRVRIT0RfRU5EID0gKAogICAgJ3JlY29uJywKICAgICd0aHJvbWJvc2lmaWVyJywKICAgICdwZW5ldHJhdGlvbicsCiAgICAnZGV0ZWN0aW9uJywKICAgICdsb29rdXAnLAogICAgJ3NjYW4tbWV0aG9kJywKICAgICdwb2tlJywKICAgICdmaW5nZXInLAogICAgJ2p1bmstcHVuY2gnLAogICAgJ2hvb2tlcicsCiAgICAncHJvYnVsYXRvcicsCiAgICAnamlnZ2VyeS1wb2tlcnknLAogICAgJ2Zpbmdsb25nZXInLAogICAgJ3J1bWluYXRpb24nLAogICAgJ2luZnJhc3RydWN0dXJlJywKICAgICdiYWxscHVuY2hlcicsCiAgICAnZW11bHNpZmllcicsCiAgICAnZW50YW5nbGVtZW50JywKKQoKIyMjIyMjIyMjIyMjIyMjIyMKIyBTZXJ2aWNlIE5hbWVzICMKIyMjIyMjIyMjIyMjIyMjIyMKIyBUaGVzZSBzaG91bGQgYmUgImFjdHVhbCIgc2VydmljZXMKU0VSVklDRV9QUkUgPSAoCiAgICAnaW50ZXJuZXQnLAogICAgJ3dlYmxvZ2ljJywKICAgICdpZCcsCiAgICAnd2ViJywKICAgICdmdHAnLAogICAgJ3htbCcsCiAgICAnanNvbnAnLAogICAgJ2Nsb3VkJywKICAgICdhbWF6b24nLAogICAgJ3R3aXR0ZXInLAogICAgJ2ZhY2Vib29rJywKICAgICdnaWpvZScsCiAgICAnZWJheScsCiAgICAnZ29vZ2xlJwopCiMgQW5kIHRoZXNlIHNob3VsZCBqdXN0IGJlIHJpZGljdWxvdXMKU0VSVklDRV9FTkQgPSAoCiAgICAnYmFkZ2VyJywKICAgICdzdWNrZXInLAogICAgJ2FwYWNoZScsCiAgICAnbmFwc3RlcicsCiAgICAnY2F0aG9saWMnLAogICAgJ2hvbmV5IGJhZGdlcicsCiAgICAnd29sdmVyaW5lJywKICAgICdob3JzZWZseScsCiAgICAnZnVuZ3VzJywKICAgICdtZWF0JywKICAgICd0ZXN0ZScsCikKCiMjIyMjIyMjIyMjIyMjIyMKIyBBY3Rpb24gTmFtZXMgIwojIyMjIyMjIyMjIyMjIyMjCkFDVElPTlMgPSAoCiAgICAnQ0FMTElORyBUQUZUJywKICAgICcgPj4+IEZJUkVXQUxMIDYwJSBHT05FID4+PiAnLAogICAgJ0xPR0dJTkcgT0ZGIElSQycsCiAgICAnRVhQTE9ESU5HIEFSUkFZUycsCiAgICAnTU9WSU5HIEZVTkRTIElOVE8gU1dJU1MgQkFOSyBBQ0NPVU5UJywKICAgICdHQUlOSU5HIEVZRSBPRiBUSEUgVElHRVInLAogICAgJ1JFQk9PVElORyBST1VURVJTJywKICAgICdVU0lORyBQR1AnLAogICAgJ0hJRElORycsCiAgICAnVVBMT0FESU5HIFNQQUNFIEpBTScsIAogICAgJ0VNUFRZSU5HIFRSQVNIQ0FOJywgCiAgICAnU0VORElORyBNU0dfT09CJywgCiAgICAnQ0FMQ1VMQVRJTkcgU0VORE1BSUwgQVhJUycsCiAgICAnTU9VTlRJTkcgRklMRVNZU1RFTSBSRUFET05MWScsCiAgICAnUkVUSUNVTEFUSU5HIFNQTElORVMnLAogICAgJ1NFTEYtREVTVFJVQ1QgQUNUSVZBVEVEJywKICAgICdBQ1RJVkFUSU5HIFNQQU1KQUNVTEFUT1InLAogICAgJ0RFTElWRVJJTkcgTUVSQ0hBTkRJU0UnLAogICAgJ0RST1BQSU5HIE1BRCBTQ0lFTkNFJywKICAgICdDQUxDVUxBVElORycsCiAgICAnUkVCT09USU5HJywKICAgICdMSVFVSURBVElORyBBTEwgQVNTRVRTJywKKQoKIyMjIyMjIyMjIyMjIwojIEZlZCBOYW1lcyAjCiMjIyMjIyMjIyMjIyMKIyBDb21lIG9uLCBiZSBjcmVhdGl2ZSEKRkVEUyA9ICgKICAgICdGQkknLAogICAgJ0NJQScsCiAgICAnUklBQScsCiAgICAnQU9MJywKICAgICdTV0VERU4nLAogICAgJ01BREQnLAogICAgJ1VVTkVUJywKICAgICdOQU1CTEEnLAogICAgJ1dBTE1BUlQnLAogICAgJ1BFVEEnLAogICAgJ01QQUEnLAogICAgJ0NFUk4nLAogICAgJ05XQScsCiAgICAnQ0VSTicsCiAgICAnS0tLJywKICAgICczSCcsCiAgICAnTkFTQScsCiAgICAnS0dCJywKICAgICdOQ0FBJywKICAgICdBQ0xVJywKICAgICdOUkEnLAogICAgJ1NDSUVOVE9MT0dZJywKKQoKIyMjIyMjIyMjIyMjIyMjIwojIEtpbGwgTWV0aG9kcyAjCiMjIyMjIyMjIyMjIyMjIyMKS0lMTF9NRVRIT0RTID0gKCAKICAgICdQSU5HIFRJTUVEIE9VVCcsCiAgICAnU0hPVCBET1dOIEJZIE5PUlRIIEtPUkVBJywKICAgICdFWFBPU0VEIEJZIFdJS0lMRUFLUycsCiAgICAnQ0FMTCBUUkFDRUQgQU5EIEVYUExPREVEJywKICAgICdCTFVFU0NSRUVORUQgQlkgT1ZFUkhBQ0sgSURTIExPQ0tJTkcnLAogICAgJ1RBTEsgU0VTU0lPTiBURVJNSU5BVEVEJywKICAgICdBQ0NPVU5UIFJFTU9WRUQgQlkgQ09NUFVTRVJWRScsCiAgICAnRklSRVdBTExFRCBGUk9NIEVHWVBUJywKICAgICdDT05ORUNUSU9OIFRJTUVEIE9VVCcsCiAgICAnRklSRVdBTEwgNjAlIEdPTkUnLAogICAgJ0hBQ0tFRCBCWSBDSElORVNFJywKICAgICdORVRXT1JLIE9WRVJMT0FERUQnLAogICAgJ0dBTUUgT1ZFUicsCiAgICAnWU9VIExPU0UnLAogICAgJ0ZBVEFMSVRJWScsCikKCiMjIyMjIyMjIyMjCiMgQmFubmVycyAjCiMjIyMjIyMjIyMjClRBRyA9ICdWRVJTSU9OIHswfSBCWSB7MX0nLmZvcm1hdChfX3ZlcnNpb25fXywgX19hdXRob3JfXykKQkFOTkVSID0gIiIiCiBfX18gXyAgIF8gX19fX18gX19fX18gX19fXyAgXyAgIF8gX19fX18gX19fX18gCnxfIF98IFwgfCB8XyAgIF98IF9fX198ICBfIFx8IFwgfCB8IF9fX198XyAgIF98CiB8IHx8ICBcfCB8IHwgfCB8ICBffCB8IHxfKSB8ICBcfCB8ICBffCAgIHwgfCAgCiB8IHx8IHxcICB8IHwgfCB8IHxfX198ICBfIDx8IHxcICB8IHxfX18gIHwgfCAgCnxfX198X3wgXF98IHxffCB8X19fX198X3wgXF9cX3wgXF98X19fX198IHxffCAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiBfICAgXyAgICBfICAgIF9fICBfX19fXyAgX19fXyAgCnwgfCB8IHwgIC8gXCAgIFwgXC8gLyBfIFx8ICBfIFwgCnwgfF98IHwgLyBfIFwgICBcICAvIHwgfCB8IHxfKSB8CnwgIF8gIHwvIF9fXyBcICAvICBcIHxffCB8ICBfIDwgCnxffCB8Xy9fLyAgIFxfXC9fL1xfXF9fXy98X3wgXF9cCgp7dGFnfQoiIiIuZm9ybWF0KHRhZz1UQUcpCgpPV05FRCA9ICIiIgogIF9fXyAgICAgICAgICAgICAgICAgX19fX18gICAgIF8gCiAvIF8gXF9fICAgICAgX19fIF9fIHxfX18gLyAgX198IHwKfCB8IHwgXCBcIC9cIC8gLyAnXyBcICB8XyBcIC8gX2AgfAp8IHxffCB8XCBWICBWIC98IHwgfCB8X19fKSB8IChffCB8CiBcX19fLyAgXF8vXF8vIHxffCB8X3xfX19fLyBcX18sX3wKIiIiCiAgICAKCiMgQ2xhc3NlcwpjbGFzcyBQcm9ncmVzc01ldGVyKG9iamVjdCk6CiAgICAiIiIKICAgIEEgcHJvZ3Jlc3MgbWV0ZXIuIER1aC4KICAgICIiIgogICAgZGVmIF9faW5pdF9fKHNlbGYsICoqa3cpOgogICAgICAgICMgV2hhdCBtZXNzYWdlIGRvIHdlIHdhbnQgdG8gZGlzcGxheT8KICAgICAgICBzZWxmLm1lc3NhZ2UgPSBrdy5nZXQoJ21lc3NhZ2UnLCAnJykKICAgICAgICBpZiBzZWxmLm1lc3NhZ2U6CiAgICAgICAgICAgIHNlbGYubWVzc2FnZSArPSAnICcKICAgICAgICAjIFdoYXQgdGltZSBkbyB3ZSBzdGFydCB0cmFja2luZyBvdXIgcHJvZ3Jlc3MgZnJvbT8KICAgICAgICBzZWxmLnRpbWVzdGFtcCA9IGt3LmdldCgndGltZXN0YW1wJywgdGltZS50aW1lKCkpCiAgICAgICAgIyBXaGF0IGtpbmQgb2YgdW5pdCBhcmUgd2UgdHJhY2tpbmc/CiAgICAgICAgc2VsZi51bml0ID0gc3RyKGt3LmdldCgndW5pdCcsICcnKSkKICAgICAgICAjIE51bWJlciBvZiB1bml0cyB0byBwcm9jZXNzCiAgICAgICAgc2VsZi50b3RhbCA9IGludChrdy5nZXQoJ3RvdGFsJywgMTAwKSkKICAgICAgICAjIE51bWJlciBvZiB1bml0cyBhbHJlYWR5IHByb2Nlc3NlZAogICAgICAgIHNlbGYuY291bnQgPSBpbnQoa3cuZ2V0KCdjb3VudCcsIDApKQogICAgICAgICMgUmVmcmVzaCByYXRlIGluIHNlY29uZHMKICAgICAgICBzZWxmLnJhdGVfcmVmcmVzaCA9IGZsb2F0KGt3LmdldCgncmF0ZV9yZWZyZXNoJywgLjUpKQogICAgICAgICMgTnVtYmVyIG9mIHRpY2tzIGluIG1ldGVyCiAgICAgICAgc2VsZi5tZXRlcl90aWNrcyA9IGludChrdy5nZXQoJ3RpY2tzJywgNjApKQogICAgICAgIHNlbGYubWV0ZXJfZGl2aXNpb24gPSBmbG9hdChzZWxmLnRvdGFsKSAvIHNlbGYubWV0ZXJfdGlja3MKICAgICAgICBzZWxmLm1ldGVyX3ZhbHVlID0gaW50KHNlbGYuY291bnQgLyBzZWxmLm1ldGVyX2RpdmlzaW9uKQogICAgICAgIHNlbGYubGFzdF91cGRhdGUgPSBOb25lCiAgICAgICAgc2VsZi5yYXRlX2hpc3RvcnlfaWR4ID0gMAogICAgICAgIHNlbGYucmF0ZV9oaXN0b3J5X2xlbiA9IDEwCiAgICAgICAgc2VsZi5yYXRlX2hpc3RvcnkgPSBbTm9uZV0gKiBzZWxmLnJhdGVfaGlzdG9yeV9sZW4KICAgICAgICBzZWxmLnJhdGVfY3VycmVudCA9IDAuMAogICAgICAgIHNlbGYubGFzdF9yZWZyZXNoID0gMAogICAgICAgIHNlbGYucHJldl9tZXRlcl9sZW4gPSAwCgogICAgZGVmIHVwZGF0ZShzZWxmLCBjb3VudCwgKiprdyk6CiAgICAgICAgbm93ID0gdGltZS50aW1lKCkKICAgICAgICAjIENhY2x1bGF0ZSByYXRlIG9mIHByb2dyZXNzCiAgICAgICAgcmF0ZSA9IDAuMAogICAgICAgICMgQWRkIGNvdW50IHRvIFRvdGFsCiAgICAgICAgc2VsZi5jb3VudCArPSBjb3VudAogICAgICAgIHNlbGYuY291bnQgPSBtaW4oc2VsZi5jb3VudCwgc2VsZi50b3RhbCkKICAgICAgICBpZiBzZWxmLmxhc3RfdXBkYXRlOgogICAgICAgICAgICBkZWx0YSA9IG5vdyAtIGZsb2F0KHNlbGYubGFzdF91cGRhdGUpCiAgICAgICAgICAgIGlmIGRlbHRhOgogICAgICAgICAgICAgICAgcmF0ZSA9IGNvdW50IC8gZGVsdGEKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhdGUgPSBjb3VudAogICAgICAgICAgICBzZWxmLnJhdGVfaGlzdG9yeVtzZWxmLnJhdGVfaGlzdG9yeV9pZHhdID0gcmF0ZQogICAgICAgICAgICBzZWxmLnJhdGVfaGlzdG9yeV9pZHggKz0gMQogICAgICAgICAgICBzZWxmLnJhdGVfaGlzdG9yeV9pZHggJT0gc2VsZi5yYXRlX2hpc3RvcnlfbGVuCiAgICAgICAgICAgIGNudCA9IDAKICAgICAgICAgICAgdG90YWwgPSAwLjAKICAgICAgICAgICAgIyBBdmVyYWdlIHJhdGUgaGlzdG9yeQogICAgICAgICAgICBmb3IgcmF0ZSBpbiBzZWxmLnJhdGVfaGlzdG9yeToKICAgICAgICAgICAgICAgIGlmIHJhdGUgPT0gTm9uZToKICAgICAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICAgICAgY250ICs9IDEKICAgICAgICAgICAgICAgIHRvdGFsICs9IHJhdGUKICAgICAgICAgICAgcmF0ZSA9IHRvdGFsIC8gY250CiAgICAgICAgc2VsZi5yYXRlX2N1cnJlbnQgPSByYXRlCiAgICAgICAgc2VsZi5sYXN0X3VwZGF0ZSA9IG5vdwogICAgICAgICMgRGV2aWNlIFRvdGFsIGJ5IG1ldGVyIGRpdmlzaW9uCiAgICAgICAgdmFsdWUgPSBpbnQoc2VsZi5jb3VudCAvIHNlbGYubWV0ZXJfZGl2aXNpb24pCiAgICAgICAgaWYgdmFsdWUgPiBzZWxmLm1ldGVyX3ZhbHVlOgogICAgICAgICAgICBzZWxmLm1ldGVyX3ZhbHVlID0gdmFsdWUKICAgICAgICBpZiBzZWxmLmxhc3RfcmVmcmVzaDoKICAgICAgICAgICAgaWYgKG5vdyAtIHNlbGYubGFzdF9yZWZyZXNoKSA+IHNlbGYucmF0ZV9yZWZyZXNoIG9yIFwKICAgICAgICAgICAgICAgIChzZWxmLmNvdW50ID49IHNlbGYudG90YWwpOgogICAgICAgICAgICAgICAgICAgIHNlbGYucmVmcmVzaCgpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5yZWZyZXNoKCkKCiAgICBkZWYgZ2V0X21ldGVyKHNlbGYsICoqa3cpOgogICAgICAgIGJhciA9ICctJyAqIHNlbGYubWV0ZXJfdmFsdWUKICAgICAgICBwYWQgPSAnICcgKiAoc2VsZi5tZXRlcl90aWNrcyAtIHNlbGYubWV0ZXJfdmFsdWUpCiAgICAgICAgcGVyYyA9IChmbG9hdChzZWxmLmNvdW50KSAvIHNlbGYudG90YWwpICogMTAwCiAgICAgICAgbWVzc2FnZSA9IHNlbGYubWVzc2FnZQogICAgICAgICNyZXR1cm4gJ1slcz4lc10gJWQlJSAgJS4xZi9zZWMnICUgKGJhciwgcGFkLCBwZXJjLCBzZWxmLnJhdGVfY3VycmVudCkKICAgICAgICByZXR1cm4gJyVzWyVzPiVzXSAlZCUlICAlLjFmL3NlYycgJSAobWVzc2FnZSwgYmFyLCBwYWQsIHBlcmMsIHNlbGYucmF0ZV9jdXJyZW50KQoKICAgIGRlZiByZWZyZXNoKHNlbGYsICoqa3cpOgogICAgICAgICMgQ2xlYXIgbGluZSBhbmQgcmV0dXJuIGN1cnNvciB0byBzdGFydC1vZi1saW5lCiAgICAgICAgI2lmIHNlbGYuY291bnQgPj0gc2VsZi50b3RhbDoKICAgICAgICAjICAgIHN5cy5zdGRvdXQud3JpdGUoJ1xuJykKICAgICAgICAjICAgIHJldHVybgoKICAgICAgICBzeXMuc3Rkb3V0LndyaXRlKCcgJyAqIHNlbGYucHJldl9tZXRlcl9sZW4gKyAnXHgwOCcgKiBzZWxmLnByZXZfbWV0ZXJfbGVuKQogICAgICAgICMgR2V0IG1ldGVyIHRleHQKICAgICAgICBtZXRlcl90ZXh0ID0gc2VsZi5nZXRfbWV0ZXIoKiprdykKICAgICAgICAjIFdyaXRlIG1ldGVyIGFuZCByZXR1cm4gY3Vyc29yIHRvIHN0YXJ0LW9mLWxpbmUKICAgICAgICBzeXMuc3Rkb3V0LndyaXRlKG1ldGVyX3RleHQgKyAnXHgwOCcqbGVuKG1ldGVyX3RleHQpKQogICAgICAgIHNlbGYucHJldl9tZXRlcl9sZW4gPSBsZW4obWV0ZXJfdGV4dCkKCiAgICAgICAgIyBBcmUgd2UgZmluaXNoZWQ/CiAgICAgICAgI2lmIHNlbGYuY291bnQgPj0gc2VsZi50b3RhbDoKICAgICAgICAjICAgIHN5cy5zdGRvdXQud3JpdGUoJ1xuJykKCiAgICAgICAgc3lzLnN0ZG91dC5mbHVzaCgpCiAgICAgICAgIyBUaW1lc3RhbXAKICAgICAgICBzZWxmLmxhc3RfcmVmcmVzaCA9IHRpbWUudGltZSgpCgoKIyBGdW5jdGlvbnMKZGVmIGRldGVjdF9zZXJ2aWNlKCk6CiAgICAiIiIKICAgIEdlbmVyYXRlIGEgcmFuZG9tIGF0dGFjayBtZXRob2QgYW5kIHNlcnZpY2UgYW5kIGdvIHRvIHRvd24hCiAgICAiIiIKICAgIG1ldGhvZCA9ICcgJy5qb2luKHJhbmRvbS5jaG9pY2UobSkgZm9yIG0gaW4gKE1FVEhPRF9QUkUsIE1FVEhPRF9NSUQsIE1FVEhPRF9FTkQpKSAKICAgIHNlcnZpY2UgPSAnICcuam9pbihyYW5kb20uY2hvaWNlKHMpIGZvciBzIGluIChTRVJWSUNFX1BSRSwgU0VSVklDRV9FTkQpKSArICcgZGFlbW9uJwogICAgCiAgICByZXR1cm4gbWV0aG9kLCBzZXJ2aWNlCiAgICAKZGVmIGxvZyhtc2csIGxvZ190eXBlPUxPR19UWVBFKToKICAgIHRzID0gZGF0ZXRpbWUuZGF0ZXRpbWUubm93KCkKICAgIHByaW50ICIlcyBbJXNdOiAlcyIgJSAodHMuY3RpbWUoKSwgbG9nX3R5cGUsIG1zZykKCmRlZiBnZXRfaXAoKToKICAgICIiIkdlbmVyYXRlIGEgcmFuZG9tIElQIGFkZHJlc3MgZm9yIGF0dGFjayB2ZWN0b3IuIiIiCiAgICBtYXggPSA0Mjk0OTY3Mjk1CiAgICByZXR1cm4gc29ja2V0LmluZXRfbnRvYShzdHJ1Y3QucGFjaygnPkwnLCBzb2NrZXQubnRvaGwocmFuZG9tLnJhbmRyYW5nZSgxLG1heCkpKSkKCmRlZiBzY2FuX2lwKGlwLCBtYXg9MTUpOgogICAgIiIiCiAgICBTY2FucyBhbiBJUC4gRGV0ZWN0cyBhbmQgcmV0dXJucyBhIHNldCBvZiBvcGVuIHBvcnRzLgogICAgIiIiCiAgICAjIFVwZGF0ZSBwcm9ncmVzcyB3aXRoIHRoZSBmYW5jeSBiYXIhCiAgICBtc2cgPSAnU0NBTk5JTkcnCiAgICBwcm9ncmVzcyA9IFByb2dyZXNzTWV0ZXIobWVzc2FnZT1tc2csIHRvdGFsPW1heCkKICAgIHdoaWxlIG1heCA+PSAwOgogICAgICAgIHByb2dyZXNzLnVwZGF0ZSgxKQogICAgICAgIG1heCAtPSAxCiAgICAgICAgdGltZS5zbGVlcChyYW5kb20ucmFuZG9tKCkpCgogICAgIyBTbGVlcCByYW5kb21seSB0byB0aHJvdyBvZmYgb3VyIHZpY3RpbSEKICAgIHRpbWUuc2xlZXAocmFuZG9tLnJhbmRvbSgpKQogICAgb3Blbl9wb3J0cyA9IHJhbmRvbS5yYW5kcmFuZ2UoMCwgcmFuZG9tLnJhbmRyYW5nZSgxLDI1KSkKCiAgICAjIFJldHVuIGlmIAogICAgaWYgbm90IG9wZW5fcG9ydHM6CiAgICAgICAgcmV0dXJuIE5vbmUKCiAgICAjIENvbGxlY3Qgb3BlbiBwb3J0cy4gS2VlcCBnb2luZyB0aWwgd2UgZ2V0IG1heCAjIHVuaXF1ZS4KICAgIHBvcnRzZXQgPSBzZXQoKQogICAgd2hpbGUgVHJ1ZToKICAgICAgICBjbnQgPSBsZW4ocG9ydHNldCkKICAgICAgICBpZiBjbnQgPj0gb3Blbl9wb3J0czogCiAgICAgICAgICAgIGJyZWFrCiAgICAgICAgcG9ydG51bSA9IHJhbmRvbS5yYW5kcmFuZ2UoMCw2NTUzNSkKICAgICAgICBwb3J0c2V0LmFkZChwb3J0bnVtKQoKICAgIHJldHVybiBwb3J0c2V0CiAgICAKZGVmIGNoZWNrX2Zvcl9mZWRzKCk6CiAgICBudW1fYSA9IHJhbmRvbS5yYW5kcmFuZ2UoMSwgNCkKICAgIG51bV9iID0gcmFuZG9tLnJhbmRyYW5nZSgxLCA0KQoKICAgIHJldHVybiBudW1fYSA9PSBudW1fYgogICAgCmRlZiBwaW5nX2lwKGlwKToKICAgICIiIlBpbmdzIGFuIElQLCBkdWguIFNsZWVwcyByYW5kb21seSBpZiBpdCBmYWlscy4gRHVoLiIiIgogICAgbiA9IHJhbmRvbS5yYW5kcmFuZ2UoMCw0KQogICAgaWYgbm90IG46CiAgICAgICAgdGltZS5zbGVlcChyYW5kb20ucmFuZG9tKCkpCiAgICAgICAgcmV0dXJuIEZhbHNlCiAgICByZXR1cm4gVHJ1ZQoKZGVmIGhhY2tfcG9ydChtYXg9NSk6CiAgICAiIiJIYWNrcyBhIHBpbmcgb24gSVA6cG9ydC4gU2VyaW91cyBidXNpbmVzcy4iIiIKICAgIG1zZyA9ICdIQUNLSU5HJwogICAgcHJvZ3Jlc3MgPSBQcm9ncmVzc01ldGVyKG1lc3NhZ2U9bXNnLCB0b3RhbD1tYXgpCiAgICB3aGlsZSBtYXggPj0gMDoKICAgICAgICBwcm9ncmVzcy51cGRhdGUoMSkKICAgICAgICBtYXggLT0gMQogICAgICAgIHRpbWUuc2xlZXAocmFuZG9tLnJhbmRvbSgpKQoKICAgIHJldHVybiByYW5kb20ucmFuZHJhbmdlKDAsIDIpCiAgICAKZGVmIGtpbGxfZmVkKCk6CiAgICAiIiJLaWxscyBhIEZlZC4gRG9wZSEiIiIKICAgIHJldHVybiByYW5kb20uY2hvaWNlKEtJTExfTUVUSE9EUykKCmRlZiBjb3ZlcnRfYWN0aW9uKCk6CiAgICAiIiJEZXRlcm1pbmUgYSBjb3ZlcnQgYWN0aW9uISBTZWNyZXQgU3F1aXJyZWwuIiIiCiAgICByZXR1cm4gcmFuZG9tLmNob2ljZShBQ1RJT05TKQogICAgICAgICAgICAgICAgCmRlZiBmaW5kX2ZlZCgpOgogICAgIiIiUmV0cmlldmUgYSBGZWQgdG8gYmUga2lsbGVkIGxhdGVyLiBIb3BlZnVsbHkuIiIiCiAgICByZXR1cm4gcmFuZG9tLmNob2ljZShGRURTKQoKZGVmIGhhY2soaXApOgogICAgIiIiCiAgICBIYWNrcyBhbiBJbnRlcm5ldCBJUC4gVXNlIHdpdGggY2F1dGlvbiEhCiAgICAiIiIKICAgICMgU28gd2UgY2FuIHRlbGwgZWFjaCBoYWNrIGFwYXJ0CiAgICBwcmludCAKICAgIGxvZygiRmluZGluZyBJbnRlcm5ldCB0YXJnZXQuLi4iKQogICAgbG9nKCJgLSBGb3VuZCBJbnRlcm5ldCB0YXJnZXQgJXMgQkVHSU4gSU5URVJORVQgSEFDS0lORyEiICUgaXApCgogICAgIyBUcnkgdG8gaGFjayBhIHBpbmchCiAgICBsb2coJ3wgYC0gSEFDS0lORyBQSU5HIE9OIFRBUkdFVDogJXMnICUgaXApCiAgICBpZiBub3QgcGluZ19pcChpcCk6CiAgICAgICAgbG9nKCd8IGAtIENPVUxEIE5PVCBIQUNLIEEgUElORyBPTiBUQVJHRVQgJXMnICUgaXApCiAgICAgICAgcmV0dXJuCgogICAgIyBUcnkgdG8gaGFjayBhIHNjYW4hCiAgICBsb2coJ3wgfCBgLSBBVFRFTVBUSU5HIEhBQ0tJTkcgU0NBTiBPRiBJTlRFUk5FVCBQT1JUUyBPTiBUQVJHRVQgJXMnICUgaXApCiAgICBwb3J0cyA9IHNjYW5faXAoaXApCiAgICBpZiBub3QgcG9ydHM6CiAgICAgICAgbG9nKCd8IHwgYC0gQ09VTEQgTk9UIEhBQ0sgSU5URVJORVQgSVAgJXMgKE5PIEhBQ0tFUiBTTE9UUyBPUEVOKScgJSBpcCkKICAgICAgICByZXR1cm4KCiAgICAjIE9rIHdlJ3JlIHJlYWR5IHRvIGhhY2shCiAgICBsb2coJ3wgfCBgLSAlZCBJTlRFUk5FVCBQT1JUUyBPTiAlcyBUSEFUIE1BWSBCRSBJTlRFUk5FVCBIQUNLQUJMRSExISExJyAlIChsZW4ocG9ydHMpLCBpcCkpCiAgICBsb2coJ3wgfCBgLSBCRUdOSU5OSU5HIElOVEVSTkVUIEhBQ0tJTkcgT0YgUE9SVFMgT04gJXMnICUgKGlwKSkKCiAgICAjIEl0ZXJhdGUgcG9ydHMgYW5kIGdvIHRvIHRvd24hIQogICAgZm9yIHBvcnQgaW4gcG9ydHM6CiAgICAgICAgIyBMZXQncyBnZXQgYSBzZXJ2aWNlIGFuZCBjaG9vc2UgdGhlIHJpZ2h0IGhhY2tlciBtZXRob2QKICAgICAgICBtZXRob2QsIHNlcnZpY2UgPSBkZXRlY3Rfc2VydmljZSgpCiAgICAgICAgbG9nKCd8IHwgfCBgLSBTRVJWSUNFIERFVEVDVEVEOiAlcyBvbiBwb3J0ICVkJyAlIChzZXJ2aWNlLCBwb3J0KSkKICAgICAgICBsb2coJ3wgfCB8IGAtIEhBQ0tFUiBNRVRIT0Q6ICVzJyAlIG1ldGhvZCkKICAgICAgICBsb2coJ3wgfCB8IGAtIEF0dGVtcHRpbmcgVENQIGhhY2tpbmcgb2YgcG9ydCAlZCBvbiBob3N0ICVzJyAlIChwb3J0LCBpcCkpIAoKICAgICAgICAjIEF3dyB5ZWFoIHdlIGdvdCBvbmUhCiAgICAgICAgaWYgaGFja19wb3J0KCk6CiAgICAgICAgICAgIGxvZygnfCB8IHwgfCBgLSAlczolZCBXQVMgU1VDQ0VTU0ZVTExZIElOVEVSTkVUIEhBQ0tFUkVEIScgJSAoaXAsIHBvcnQpKQogICAgICAgICAgICBsb2coJ3wgfCB8IHwgYC0gICAgX19fICAgICAgICAgICAgICAgICBfX19fXyAgICAgXyAnKQogICAgICAgICAgICBsb2coJ3wgfCB8IHwgYC0gICAvIF8gXF9fICAgICAgX19fIF9fIHxfX18gLyAgX198IHwnKQogICAgICAgICAgICBsb2coInwgfCB8IHwgYC0gIHwgfCB8IFwgXCAvXCAvIC8gJ18gXCAgfF8gXCAvIF9gIHwiKSAKICAgICAgICAgICAgbG9nKCd8IHwgfCB8IGAtICB8IHxffCB8XCBWICBWIC98IHwgfCB8X19fKSB8IChffCB8JykKICAgICAgICAgICAgbG9nKCd8IHwgfCB8IGAtICAgXF9fXy8gIFxfL1xfLyB8X3wgfF98X19fXy8gXF9fLF98JykKICAgICAgICAgICAgbG9nKCd8IHwgfCB8JykKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgICMgT3Igbm90IChzYWQgZmFjZSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBsb2coJ3wgfCB8IHwgYC0gJXM6JWQgQ09VTEQgTk9UIEJFIFRDUCBJTlRFUk5FVCBIQUNLRUQhJyAlIChpcCwgcG9ydCkpCgogICAgICAgICMgQmV3YXJlIG9mIGZlZHMhIQogICAgICAgIGlmIGNoZWNrX2Zvcl9mZWRzKCk6CiAgICAgICAgICAgIGZlZCA9IGZpbmRfZmVkKCkKICAgICAgICAgICAgYWN0aW9uID0gY292ZXJ0X2FjdGlvbigpCiAgICAgICAgICAgIGhvdyAgPSBraWxsX2ZlZCgpICMgU2VyaW91cyBidXNpbmVzcy4KICAgICAgICAgICAgICAgIAogICAgICAgICAgICAjIEZVQ0shISEKICAgICAgICAgICAgbG9nKCAnfCB8IHwgfCBgLSAhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhIScpCiAgICAgICAgICAgIGxvZyggJ3wgfCB8IHwgYC0gISBXQVJOSU5HIFdBUk5JTkcgV0FSTklORyBXQVJOSU5HIFdBUk5JTkcgV0FSTklORyBXQVJOSU5HICEnKQogICAgICAgICAgICBsb2coICd8IHwgfCB8IGAtICEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhJykKICAgICAgICAgICAgbG9nKCAnfCB8IHwgfCBgLSBERVRFQ1RFRCAlcyBNT05JVE9SSU5HIE9VUiBIQUNLSU5HLCBBVFRFTVBUSU5HIENPVkVSVCBBQ1RJT05TIScgJSBmZWQpIAogICAgICAgICAgICBsb2coICd8IHwgfCB8IHwgYC0gJXMuLi4nICUgYWN0aW9uKQogICAgICAgICAgICBoYWNrX3BvcnQoKQogICAgICAgICAgICBsb2coICd8IHwgfCB8IHwgYC0gWk9PTUlORyBJTi4uLicpIAogICAgICAgICAgICBoYWNrX3BvcnQoKQogICAgICAgICAgICBsb2coICd8IHwgfCB8IHwgYC0gRU5IQU5DSU5HLi4uJykKICAgICAgICAgICAgaGFja19wb3J0KCkKCiAgICAgICAgICAgICMgV2hldyEKICAgICAgICAgICAgbG9nKCAnfCB8IHwgfCB8IGAtICVzICVzISEhISEnICUgKGZlZCwgaG93KSkKCmRlZiBtYWluKCk6CiAgICAiIiJTbyBlbGVnYW50LiIiIgogICAgcHJpbnQgQkFOTkVSCgogICAgd2hpbGUgVHJ1ZToKICAgICAgICBpcCA9IGdldF9pcCgpCiAgICAgICAgaGFjayhpcCkKCmlmIF9fbmFtZV9fID09ICdfX21haW5fXyc6CiAgICBtYWluKCkK"))
